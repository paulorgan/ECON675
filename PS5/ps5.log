-------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  C:\Users\prorgan\Box\Classes\Econ 675\Problem Sets\PS5\ps5.log
  log type:  text
 opened on:  30 Oct 2018, 19:26:04

. 
. ********************************************************************************
. *** Question 2: Weak Instrument Simulations
. ********************************************************************************
. * Q2 setup
. 
. ********************************************************************************
. * Q2: OLS
. 
. 
. ********************************************************************************
. * Q2: 2SLS
. 
. 
. ********************************************************************************
. *** Question 3: Weak Instrument - Empirical Study
. ********************************************************************************
. * Q3 setup
. clear all

. 
. use Angrist_Krueger

. 
. ********************************************************************************
. * Q3.1: Angrist and Krueger (1991)
. 
. * variables for use in regressions
. local ols_short = "educ non_white SMSA married"

. local iv_short = "non_white SMSA married"

. local ols_long = "educ non_white SMSA married age_q age_sq"

. local iv_long  = "non_white SMSA married age_q age_sq"

. 
. * note going out of order from PS to match with A&K(1991)
. 
. * OLS 1 (these SEs match the table, so I don't think they use robust SEs)
. reg l_w_wage `ols_short' i.region i.YoB_ld

      Source |       SS           df       MS      Number of obs   =   329,509
-------------+----------------------------------   F(21, 329487)   =   3101.11
       Model |   25058.098        21  1193.24276   Prob > F        =    0.0000
    Residual |  126779.773   329,487  .384779286   R-squared       =    0.1650
-------------+----------------------------------   Adj R-squared   =    0.1650
       Total |  151837.871   329,508  .460801773   Root MSE        =    .62031

------------------------------------------------------------------------------
    l_w_wage |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        educ |   .0632457   .0003393   186.42   0.000     .0625808    .0639107
   non_white |  -.2574833   .0040414   -63.71   0.000    -.2654043   -.2495623
        SMSA |  -.1763007   .0028655   -61.53   0.000    -.1819169   -.1706844
     married |   .2478674   .0031666    78.28   0.000      .241661    .2540739
             |
      region |
          2  |  -.1644494   .0053262   -30.88   0.000    -.1748885   -.1540102
          3  |  -.0527654   .0041003   -12.87   0.000    -.0608018   -.0447289
          4  |  -.0920934   .0057895   -15.91   0.000    -.1034406   -.0807462
          5  |  -.1133839   .0055121   -20.57   0.000    -.1241874   -.1025804
          6  |  -.1393092   .0041035   -33.95   0.000    -.1473519   -.1312664
          7  |  -.1077725   .0050041   -21.54   0.000    -.1175803   -.0979647
          8  |  -.1031785   .0046701   -22.09   0.000    -.1123317   -.0940252
          9  |   .0159711   .0039398     4.05   0.000     .0082492     .023693
             |
      YoB_ld |
          1  |  -.0040453   .0049026    -0.83   0.409    -.0136543    .0055638
          2  |  -.0084617   .0048377    -1.75   0.080    -.0179436    .0010201
          3  |   -.008345   .0048966    -1.70   0.088    -.0179423    .0012522
          4  |  -.0111531   .0048501    -2.30   0.021    -.0206591    -.001647
          5  |  -.0208185   .0048182    -4.32   0.000    -.0302621   -.0113749
          6  |  -.0203862   .0048221    -4.23   0.000    -.0298375   -.0109349
          7  |  -.0230355   .0047764    -4.82   0.000    -.0323971   -.0136738
          8  |   -.022168   .0047353    -4.68   0.000    -.0314491   -.0128869
          9  |  -.0306364   .0047176    -6.49   0.000    -.0398827   -.0213901
             |
       _cons |   5.016428   .0068917   727.90   0.000     5.002921    5.029936
------------------------------------------------------------------------------

. 
. * output for LaTeX
. outreg2 using q3_1.tex, stats(coef se) keep(`ols_short') noaster dec(4) replace ///
>         addtext(9 Year-of-birth dummies, Yes, 8 Region-of-residence dummies, Yes) /
> //
>         ctitle(OLS 1) nor2 noobs
q3_1.tex
dir : seeout

. 
. * 2SLS 1
. ivregress2 2sls l_w_wage `iv_short' i.region i.YoB_ld ///
>         (educ = i.YoB_ld##i.QoB)
note: 0b.YoB_ld dropped because of collinearity
note: 1.YoB_ld dropped because of collinearity
note: 2.YoB_ld dropped because of collinearity
note: 3.YoB_ld dropped because of collinearity
note: 4.YoB_ld dropped because of collinearity
note: 5.YoB_ld dropped because of collinearity
note: 6.YoB_ld dropped because of collinearity
note: 7.YoB_ld dropped because of collinearity
note: 8.YoB_ld dropped because of collinearity
note: 9.YoB_ld dropped because of collinearity

Instrumental variables (2SLS) regression               Number of obs =  329509
                                                       Wald chi2(21) =30158.55
                                                       Prob > chi2   =  0.0000
                                                       R-squared     =  0.1584
                                                       Root MSE      =  .62273

------------------------------------------------------------------------------
    l_w_wage |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        educ |   .0805518   .0163846     4.92   0.000     .0484385     .112665
   non_white |  -.2302179   .0261251    -8.81   0.000    -.2814221   -.1790136
        SMSA |  -.1581466   .0174229    -9.08   0.000    -.1922948   -.1239985
     married |   .2439689   .0048706    50.09   0.000     .2344227    .2535152
             |
      region |
          2  |  -.1355007   .0279182    -4.85   0.000    -.1902194   -.0807821
          3  |  -.0409571    .011911    -3.44   0.001    -.0643023    -.017612
          4  |  -.0879569   .0070079   -12.55   0.000    -.1016921   -.0742216
          5  |  -.1033678   .0109775    -9.42   0.000    -.1248833   -.0818523
          6  |  -.1203118   .0184479    -6.52   0.000    -.1564689   -.0841546
          7  |  -.0950523   .0130463    -7.29   0.000    -.1206226   -.0694819
          8  |  -.0867657   .0162276    -5.35   0.000    -.1185711   -.0549602
          9  |   .0343439   .0178348     1.93   0.054    -.0006118    .0692995
             |
      YoB_ld |
          1  |  -.0064838   .0054362    -1.19   0.233    -.0171385    .0041709
          2  |  -.0118228   .0058059    -2.04   0.042    -.0232022   -.0004435
          3  |  -.0128383   .0065003    -1.98   0.048    -.0255787    -.000098
          4  |  -.0162055   .0068249    -2.37   0.018     -.029582    -.002829
          5  |  -.0271844   .0077269    -3.52   0.000    -.0423289   -.0120399
          6  |  -.0275322   .0083179    -3.31   0.001    -.0438349   -.0112294
          7  |  -.0313496   .0092155    -3.40   0.001    -.0494117   -.0132875
          8  |  -.0319571   .0104142    -3.07   0.002    -.0523685   -.0115457
          9  |  -.0412408   .0110988    -3.72   0.000    -.0629941   -.0194875
             |
       _cons |   4.784997    .219171    21.83   0.000      4.35543    5.214564
------------------------------------------------------------------------------
Instrumented:  educ
Instruments:   non_white SMSA married 2.region 3.region 4.region 5.region
               6.region 7.region 8.region 9.region 1.YoB_ld 2.YoB_ld
               3.YoB_ld 4.YoB_ld 5.YoB_ld 6.YoB_ld 7.YoB_ld 8.YoB_ld
               9.YoB_ld 2.QoB 3.QoB 4.QoB 1.YoB_ld#2.QoB 1.YoB_ld#3.QoB
               1.YoB_ld#4.QoB 2.YoB_ld#2.QoB 2.YoB_ld#3.QoB 2.YoB_ld#4.QoB
               3.YoB_ld#2.QoB 3.YoB_ld#3.QoB 3.YoB_ld#4.QoB 4.YoB_ld#2.QoB
               4.YoB_ld#3.QoB 4.YoB_ld#4.QoB 5.YoB_ld#2.QoB 5.YoB_ld#3.QoB
               5.YoB_ld#4.QoB 6.YoB_ld#2.QoB 6.YoB_ld#3.QoB 6.YoB_ld#4.QoB
               7.YoB_ld#2.QoB 7.YoB_ld#3.QoB 7.YoB_ld#4.QoB 8.YoB_ld#2.QoB
               8.YoB_ld#3.QoB 8.YoB_ld#4.QoB 9.YoB_ld#2.QoB 9.YoB_ld#3.QoB
               9.YoB_ld#4.QoB

. 
. * output for LaTeX
. outreg2 using q3_1.tex, stats(coef se) keep(`ols_short') noaster dec(4) append ///
>         addtext(9 Year-of-birth dummies, Yes, 8 Region-of-residence dummies, Yes) /
> //
>         ctitle(2SLS 1) nor2 noobs
q3_1.tex
dir : seeout

.                         
. * OLS 2
. reg l_w_wage `ols_long' i.region i.YoB_ld

      Source |       SS           df       MS      Number of obs   =   329,509
-------------+----------------------------------   F(23, 329485)   =   2831.65
       Model |   25059.716        23  1089.55287   Prob > F        =    0.0000
    Residual |  126778.155   329,485  .384776711   R-squared       =    0.1650
-------------+----------------------------------   Adj R-squared   =    0.1650
       Total |  151837.871   329,508  .460801773   Root MSE        =     .6203

------------------------------------------------------------------------------
    l_w_wage |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        educ |   .0632378   .0003393   186.37   0.000     .0625728    .0639028
   non_white |  -.2574534   .0040414   -63.70   0.000    -.2653745   -.2495323
        SMSA |  -.1762903   .0028655   -61.52   0.000    -.1819066   -.1706741
     married |   .2478785   .0031666    78.28   0.000     .2416721    .2540849
       age_q |  -.0759683    .060413    -1.26   0.209     -.194376    .0424394
      age_sq |   .0007702   .0006694     1.15   0.250    -.0005418    .0020822
             |
      region |
          2  |  -.1644554   .0053262   -30.88   0.000    -.1748945   -.1540163
          3  |  -.0527515   .0041003   -12.87   0.000     -.060788   -.0447151
          4  |  -.0921064   .0057895   -15.91   0.000    -.1034536   -.0807593
          5  |  -.1133571   .0055121   -20.57   0.000    -.1241606   -.1025536
          6  |  -.1393424   .0041035   -33.96   0.000    -.1473852   -.1312996
          7  |  -.1077988   .0050041   -21.54   0.000    -.1176066   -.0979909
          8  |  -.1032796   .0046703   -22.11   0.000    -.1124333   -.0941258
          9  |   .0159563   .0039398     4.05   0.000     .0082343    .0236782
             |
      YoB_ld |
          1  |  -.0043341   .0083191    -0.52   0.602    -.0206394    .0119711
          2  |  -.0105828   .0132897    -0.80   0.426    -.0366303    .0154646
          3  |  -.0138386   .0177416    -0.78   0.435    -.0486117    .0209345
          4  |  -.0216063   .0214481    -1.01   0.314     -.063644    .0204314
          5  |  -.0377081   .0244706    -1.54   0.123    -.0856697    .0102535
          6  |  -.0452488   .0270595    -1.67   0.094    -.0982846     .007787
          7  |   -.057496   .0295022    -1.95   0.051    -.1153194    .0003274
          8  |   -.067676     .03212    -2.11   0.035    -.1306303   -.0047217
          9  |  -.0888003   .0353575    -2.51   0.012    -.1581001   -.0195006
             |
       _cons |    6.88961   1.357011     5.08   0.000     4.229908    9.549313
------------------------------------------------------------------------------

. 
. * output for LaTeX
. outreg2 using q3_1.tex, stats(coef se) keep(`ols_long') noaster dec(4) append ///
>         addtext(9 Year-of-birth dummies, Yes, 8 Region-of-residence dummies, Yes) /
> //
>         ctitle(OLS 2) nor2 noobs
q3_1.tex
dir : seeout

. 
. * 2SLS 2
. ivregress2 2sls l_w_wage `iv_long' i.region i.YoB_ld ///
>     (educ = i.YoB_ld##i.QoB)
note: 0b.YoB_ld dropped because of collinearity
note: 1.YoB_ld dropped because of collinearity
note: 2.YoB_ld dropped because of collinearity
note: 3.YoB_ld dropped because of collinearity
note: 4.YoB_ld dropped because of collinearity
note: 5.YoB_ld dropped because of collinearity
note: 6.YoB_ld dropped because of collinearity
note: 7.YoB_ld dropped because of collinearity
note: 8.YoB_ld dropped because of collinearity
note: 9.YoB_ld dropped because of collinearity
note: 9.YoB_ld#4.QoB dropped due to collinearity

Instrumental variables (2SLS) regression               Number of obs =  329509
                                                       Wald chi2(23) =30391.57
                                                       Prob > chi2   =  0.0000
                                                       R-squared     =  0.1648
                                                       Root MSE      =  .62037

------------------------------------------------------------------------------
    l_w_wage |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        educ |   .0599536   .0289846     2.07   0.039     .0031447    .1167624
   non_white |  -.2626233   .0458024    -5.73   0.000    -.3523945   -.1728522
        SMSA |  -.1797347     .03053    -5.89   0.000    -.2395724   -.1198969
     married |   .2486185   .0072576    34.26   0.000     .2343938    .2628432
       age_q |  -.0741201   .0625819    -1.18   0.236    -.1967785    .0485382
      age_sq |   .0007427    .000712     1.04   0.297    -.0006528    .0021383
             |
      region |
          2  |  -.1699475    .048758    -3.49   0.000    -.2655113   -.0743836
          3  |  -.0549903   .0201772    -2.73   0.006    -.0945369   -.0154436
          4  |  -.0928903   .0090208   -10.30   0.000    -.1105708   -.0752098
          5  |   -.115255   .0176329    -6.54   0.000    -.1498149   -.0806952
          6  |  -.1429486   .0320871    -4.46   0.000    -.2058381   -.0800591
          7  |  -.1102132    .021887    -5.04   0.000    -.1531109   -.0673155
          8  |  -.1064001    .027931    -3.81   0.000    -.1611438   -.0516563
          9  |   .0124709   .0310094     0.40   0.688    -.0483065    .0732482
             |
      YoB_ld |
          1  |  -.0047228   .0089993    -0.52   0.600    -.0223611    .0129155
          2  |  -.0115935   .0160062    -0.72   0.469    -.0429651    .0197781
          3  |  -.0153764   .0223381    -0.69   0.491    -.0591583    .0284055
          4  |  -.0237303   .0284858    -0.83   0.405    -.0795614    .0321009
          5  |  -.0402118   .0329715    -1.22   0.223    -.1048347    .0244111
          6  |  -.0481793   .0374322    -1.29   0.198    -.1215451    .0251865
          7  |  -.0607297   .0410475    -1.48   0.139    -.1411813    .0197219
          8  |  -.0710949   .0440702    -1.61   0.107     -.157471    .0152812
          9  |  -.0924773   .0479925    -1.93   0.054    -.1865408    .0015863
             |
       _cons |   6.909486   1.368442     5.05   0.000     4.227389    9.591583
------------------------------------------------------------------------------
Instrumented:  educ
Instruments:   non_white SMSA married age_q age_sq 2.region 3.region
               4.region 5.region 6.region 7.region 8.region 9.region
               1.YoB_ld 2.YoB_ld 3.YoB_ld 4.YoB_ld 5.YoB_ld 6.YoB_ld
               7.YoB_ld 8.YoB_ld 9.YoB_ld 2.QoB 3.QoB 4.QoB 1.YoB_ld#2.QoB
               1.YoB_ld#3.QoB 1.YoB_ld#4.QoB 2.YoB_ld#2.QoB 2.YoB_ld#3.QoB
               2.YoB_ld#4.QoB 3.YoB_ld#2.QoB 3.YoB_ld#3.QoB 3.YoB_ld#4.QoB
               4.YoB_ld#2.QoB 4.YoB_ld#3.QoB 4.YoB_ld#4.QoB 5.YoB_ld#2.QoB
               5.YoB_ld#3.QoB 5.YoB_ld#4.QoB 6.YoB_ld#2.QoB 6.YoB_ld#3.QoB
               6.YoB_ld#4.QoB 7.YoB_ld#2.QoB 7.YoB_ld#3.QoB 7.YoB_ld#4.QoB
               8.YoB_ld#2.QoB 8.YoB_ld#3.QoB 8.YoB_ld#4.QoB 9.YoB_ld#2.QoB
               9.YoB_ld#3.QoB

.         
. * output for LaTeX
. outreg2 using q3_1.tex, stats(coef se) keep(`ols_long') noaster dec(4) append ///
>         addtext(9 Year-of-birth dummies, Yes, 8 Region-of-residence dummies, Yes) /
> //
>         ctitle(2SLS 2) nor2 noobs
q3_1.tex
dir : seeout

. 
end of do-file

. do "C:\Users\prorgan\AppData\Local\Temp\STD2f80_000000.tmp"

. local iv_short = "non_white SMSA married"

. permute QoB beta = _b(educ), reps(25) seed(22): ///
>         ivregress2 2sls l_w_wage `iv_short' i.region i.YoB_ld ///
>         (educ = i.YoB_ld##i.QoB)
invalid expression: _b
r(198);

end of do-file

r(198);

. help permute

. do "C:\Users\prorgan\AppData\Local\Temp\STD2f80_000000.tmp"

. local iv_short = "non_white SMSA married"

. permute QoB beta = e(b), reps(25) seed(22): ///
>         ivregress2 2sls l_w_wage `iv_short' i.region i.YoB_ld ///
>         (educ = i.YoB_ld##i.QoB)
(running ivregress2 on estimation sample)
matrix operators that return matrices not allowed in this context
error in expression: e(b)
r(509);

end of do-file

r(509);

. do "C:\Users\prorgan\AppData\Local\Temp\STD2f80_000000.tmp"

. local iv_short = "non_white SMSA married"

. permute QoB beta = _b["educ"], reps(25) seed(22): ///
>         ivregress2 2sls l_w_wage `iv_short' i.region i.YoB_ld ///
>         (educ = i.YoB_ld##i.QoB)
(running ivregress2 on estimation sample)

Permutation replications (25)
----+--- 1 ---+--- 2 ---+--- 3 ---+--- 4 ---+--- 5 
.........................

Monte Carlo permutation results                 Number of obs     =    329,509

      command:  ivregress2 2sls l_w_wage non_white SMSA married i.region i.YoB_ld
                    (educ = i.YoB_ld##i.QoB)
         beta:  _b["educ"]
  permute var:  QoB

------------------------------------------------------------------------------
T            |     T(obs)       c       n   p=c/n   SE(p) [95% Conf. Interval]
-------------+----------------------------------------------------------------
        beta |   .0805518       7      25  0.2800  0.0898  .1207167   .4938768
------------------------------------------------------------------------------
Note: Confidence interval is with respect to p=c/n.
Note: c = #{|T| >= |T(obs)|}

. 
end of do-file

. exit, clear
